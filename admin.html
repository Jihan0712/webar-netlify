<!DOCTYPE html>
<html>
<head>
  <title>AR Admin</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
    input, select, button { padding: 10px; margin: 10px 0; width: 100%; }
    #status { color: green; }
  </style>
</head>
<body>
  <h1>AR Content Admin</h1>
  
  <input type="password" id="password" placeholder="Admin password">
  <label>Custom Marker Name (without .fset):</label>
  <input type="text" id="markerName" value="my-logo" placeholder="e.g., my-logo">
  <select id="mediaType">
    <option value="image">Image</option>
    <option value="video">Video</option>
  </select>
  <input type="url" id="mediaUrl" placeholder="Public URL (e.g., .jpg, .mp4)">
  <button onclick="saveConfig()">Save</button>
  <p id="status"></p>

  <script>
  const ADMIN_PASSWORD = "123";
  const GIST_ID = "de164ff34fad007099e8bf2668ae1d61"; //  REPLACE with your Gist ID
  const GITHUB_TOKEN = "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"; //  REPLACE with your token

  function login() {
    if (document.getElementById('password').value === ADMIN_PASSWORD) {
      document.getElementById('adminForm').classList.remove('secret');
    } else {
      alert("Incorrect password!");
    }
  }

  async function saveConfig() {
    const markerName = document.getElementById('markerName').value;
    const mediaType = document.getElementById('mediaType').value;
    const mediaUrl = document.getElementById('mediaUrl').value;

    if (!mediaUrl) {
      alert("Please enter a URL");
      return;
    }

    const config = {
      markerName: markerName,
      mediaType: mediaType,
      mediaUrl: mediaUrl
    };

    // Update Gist
    const response = await fetch(`https://api.github.com/gists/${GIST_ID}`, {
      method: 'PATCH',
      headers: {
        'Authorization': `token ${GITHUB_TOKEN}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        files: {
          "ar-config.json": {
            content: JSON.stringify(config, null, 2)
          }
        }
      })
    });

    if (response.ok) {
      document.getElementById('status').innerText = "✅ Saved! Refresh the AR page.";
    } else {
      document.getElementById('status').innerText = "❌ Error: " + (await response.text());
    }
  }
</script>
</body>
</html>